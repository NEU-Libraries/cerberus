- if defined?(remote) && remote == true
  .modal-header
    %button.close{"aria-hidden" => "true", "data-dismiss" => "modal", type: "button"} &#215;
    %h3#ajaxModalLabel Create New #{ t('drs.compilations.name').capitalize }
= form_for( @set, :remote => ((defined?(remote) && remote == true) ? true : false) ) do |f|
  %div{:class=>((defined?(remote) && remote == true) ? "modal-body" : "")}
    - if "#{@set.class}" == "Compilation"
      - type = 'compilation'
    - else
      - type = 'set'
    - if params[:parent].present?
      = f.hidden_field :parent, name: "set[parent]", :value => params[:parent]
    %fieldset
      .row-fluid
        .span8
          = f.label :title, "Title", class: "required-label", title: "Required Field", data: { toggle: "tooltip" }
          = f.text_field :title, required: true, pattern: ".*\\S.*", class: "input-block-level", placeholder: "University Libraries", name: "#{type}[title][]"
        - if "#{@set.class}" != "Compilation"
          .span4
            = f.label :thumbnail, "Upload thumbnail"
            = f.file_field :thumbnail, name: 'thumbnail', accept:".jpg,.jpeg,.png"
            %span.help-block
              Will be displayed on collection pages. (150px by 150px)
      = f.label :description, "Description"
      = f.text_area :description, pattern: ".*\\S.*", class: "input-block-level", rows: 5, name: "#{type}[description][]"
      .row-fluid
        %fieldset.span6
          %legend Mass Permissions
          = label_tag :mass_permissions, "Choose Mass Permissions:"
          = select_tag :mass_permissions, options_for_select( "#{@set.class}" != 'Compilation' ? @set.valid_mass_permissions : ["public", "private"], @set.mass_permissions) , class: "span12", name: "#{type}[mass_permissions]"
          %p.help-block
            %ul
              %li Setting to 'public' will allow anyone accessing the site to see your collection.
              %li Setting to 'private' will only allow users and groups explicated below to see your collection.
        %fieldset.span6
          %legend Permissions
          = render partial: 'shared/sets/data_form_permissions_element', locals: {:f => f, :array_type => type, :permissions => filtered_permissions(@set) }
          %button#add_another_permission.btn.btn-success.btn-block{:type => "button"}
            %i.icon-plus-sign.icon-large
            Add Permission
  -if !defined?(remote)
    .form-actions
      = f.submit class: ['btn', 'btn-primary'], value: 'Submit', data: { disable_with: "Please wait..."}
      - if params[:action] == "edit"
        / Only specifying collection here, because community is behind /admin and has it's own partial
        %a{ href: "#cancelEditModal", :class => ["btn", "btn-warning"], data: { toggle: "modal" } }
          Cancel
      -else
        = button_tag "Reset", class: 'btn', type: :reset
  -else
    = hidden_field_tag(:entry_id, params[:entry_id])
    .modal-footer
      = f.submit class: "btn btn-primary", data: { disable_with: "Please wait..."}
      %button.btn{"data-dismiss" => "modal"} Close

= render partial: 'shared/cancel_edit_modal', locals: { item: @set }
